# AUTOGENERATED! DO NOT EDIT! File to edit: 00_utils.data.dataset.ipynb (unless otherwise specified).

__all__ = ['get_dataset', 'get_train_val_split']

# Cell
from ...imports import *
from ..vizualize import *

# Cell
def get_dataset(filepath, seed=None):
    '''
        Args:

            filepath:
                path to the train/test file

        return:
            list containing the image name and label
    '''
    with open(filepath,'r') as file:
        cxr_list = np.array([line.rstrip('\n') for line in file])
    cxr_list.sort()

    if seed is not None:
        np.random.seed(seed)

    np.random.shuffle(cxr_list)

    return np.array(cxr_list)

# Cell
def get_train_val_split(train_list, valid_pct = 0.2, seed = None):
    '''
        Args:

            train_list:
                list containing the image and labels string

            valid_pct:
                default = 0.2
                valiation split ratio

            seed:
                default is None
                seed value for reproducibility
    '''
    content_list = train_list

    if seed is not None:
        np.random.seed(seed)

    idx = list(range(len(content_list)))
    np.random.shuffle(idx)

    valid_split = int(valid_pct * len(content_list))

    valid_idx = idx[valid_split:]
    train_idx = idx[:valid_split]

    train_list = content_list[valid_idx]
    valid_list = content_list[train_idx]

    return train_list, valid_list